/*!
 * Justified Gallery - v3.7.0
 * http://miromannino.github.io/Justified-Gallery/
 * Copyright (c) 2015-2016 Miro Mannino
 * Licensed under the MIT license.
 */
(function ($) {
  $.fn.justifiedGallery = function (arg) {
    var settings = $.extend({}, $.fn.justifiedGallery.defaults, arg);
    var rows = [];
    this.each(function () {
      var $gallery = $(this);
      $gallery.find('img').each(function () {
        var $img = $(this);
        var width = $img.width();
        var height = $img.height();
        var ratio = width / height;
        rows.push({ $img: $img, width: width, height: height, ratio: ratio });
      });
      var rowWidth = 0;
      var rowImages = [];
      $.each(rows, function (index, imgData) {
        rowWidth += imgData.width;
        rowImages.push(imgData.$img);
        if (rowWidth >= settings.maxRowHeight) {
          var rowHeight = settings.maxRowHeight;
          var rowAspectRatio = rowWidth / rowHeight;
          var scaledRowWidth = rowHeight * rowAspectRatio;
          var totalGap = (rowImages.length - 1) * settings.margins;
          var scaledWidth = (scaledRowWidth - totalGap) / rowImages.length;
          $.each(rowImages, function (index, $img) {
            $img.width(scaledWidth);
          });
          rowWidth = 0;
          rowImages = [];
        }
      });
    });
    return this;
  };
  $.fn.justifiedGallery.defaults = {
    margins: 5,
    maxRowHeight: 120
  };
}(jQuery));
